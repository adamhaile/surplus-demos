<!doctype html>
<title>Minimalist TodoMVC App in S.js</title>
<script type="text/javascript-htmlliterals">
    // 1) define our array of todos and how to create a new one
    var todos = S.array([]),
        addTodo = t => todos.push({ title: S.data(t.title), done: S.data(!!t.done) }),
        // 2) to add new todos, we need a title and func to push it onto the array
        newTitle = S.data(""),
        pushNewTitle = () => { addTodo({ title: newTitle() }); newTitle(''); },
        // 3) build our view -- no update code, just a declarative description
        view =
            <input type="text" @Html.data(newTitle) /> <a onclick = pushNewTitle>+</a>
            @todos().map(todo =>
                <div>
                    <input type="checkbox" @Html.data(todo.done) />
                    <input type="text" @Html.data(todo.title) />
                    <a onclick = (() => todos.remove(todo))>&times;</a>
                </div>);

    // 4) read in our initial todos from localStorage, and write them when they change
    if (localStorage.todos) JSON.parse(localStorage.todos).forEach(addTodo);
    S(() => localStorage.todos = JSON.stringify(todos()));

    // 5) finally, append our view to the document
    document.body.appendChild(view);
</script>
<script src="../dist/surplus.js"></script>
